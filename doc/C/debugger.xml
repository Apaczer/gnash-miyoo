<?xml version="1.0" encoding="utf-8"?>
<sect2 id="debugger">
  <title>Flash Debugger</title>

  <para>
    Built into Gnash is a debugger for Flash movies. As there are no
    line numbers nor real addresses in memory for symbols, it's
    difficult to know now to set breakpoints. The existing debugger
    implementation is limited to variables watch points and function
    breakpoints.
  </para>

  <para>
    Most of the debugger commands display information about variables,
    the stack, registers, or ActionScript objects. It is also possible
    to change these values in place when debugging to help change the
    behaviour of a movie to determine the true problem.
  </para>

  <para>
    Gnash developers can also insert a break where ever they want by
    adding a few lines of code to the source file and recompiling. The
    initial line gets a handle for the running debugger, and the
    second, a call to <emphasis>Debugger::console()</emphasis> will
    break at that point.
    <programlisting>
      static gnash::Debugger&amp; debugger = gnash::Debugger::getDefaultInstance();
      debugger.console();
    </programlisting>
  </para>

  <variablelist>
    <varlistentry>
      <term>?</term>
      <listitem>
	<para>
	  Display a help screen of commands.
	</para>
      </listitem>
    </varlistentry>
    
    <varlistentry>
      <term>q</term>
      <listitem>
	<para>
	  Quit Gnash.
	</para>
      </listitem>
    </varlistentry>
    
    <varlistentry>
      <term>t</term>
      <listitem>
	<para>
	  Toggle Trace Mode on or off. Trace mode prints a disassemble
	  for each opcode as it executes in a similar fashion to the
	  <emphasis>-va</emphasis> option.
	</para>
      </listitem>
    </varlistentry>
    
    <varlistentry>
      <term>c</term>
      <listitem>
	<para>
	  Continue executing the movie. It will continue until a break
	  or watch point is hit, or continue to the end of the movie
	  if not.
	</para>
      </listitem>
    </varlistentry>
    
    <varlistentry>
      <term>d</term>
      <listitem>
	<para>
	  Dissasemble the current opcode.
	</para>
      </listitem>
    </varlistentry>
    
   </variablelist>

   <para>
     Info commands are all started with the <emphasis>i</emphasis>
     command, which is an abbreviation for <emphasis>&quot;info&quot;</emphasis>.  
     The info commands dump out information on the state of the program.
   </para>

   <variablelist>
      <varlistentry>
	<term>i</term>
	<listitem>
	  <para>
	    Dumps the movie infomation, version number, filename,
	    etc...
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>f</term>
	<listitem>
	  <para>
	    Dumps the stack frame entries.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>s</term>
	<listitem>
	  <para>
	    Dump the symbol tables. Everytime a function or method is
	    created it's stored in a symbol table along with it's
	    address. This function is probably only useful to Gnash
	    developers. 
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>g</term>
	<listitem>
	  <para>
	    Display the values of the 4 global registers.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>r</term>
	<listitem>
	  <para>
	    Display the values of the local registers, if any exist.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>l</term>
	<listitem>
	  <para>
	    Display the values of all the local variables..
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>w</term>
	<listitem>
	  <para>
	    List the watchpoints.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>b</term>
	<listitem>
	  <para>
	    List all the breakpoints.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>c</term>
	<listitem>
	  <para>
	    List the Call Stack.
	  </para>
	</listitem>
      </varlistentry>

   </variablelist>

   <para>
     Watch points are debugger commands that drop you into the
     debugger console when the specified variable's value is either
     read, or changed.
   </para>

   <variablelist>
     <varlistentry>
       <term>name r</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is read.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>name w</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is
	   written to.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>name b</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is read
	   or written to.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>d</term>
       <listitem>
	 <para>
	   Delete a watchpoint by name.
	 </para>
       </listitem>
     </varlistentry>
   </variablelist>
    
   <para>
     Break points are debugger commands that drop you into the
     debugger console when the specified function is about to be
     executed by the Flash VM.
   </para>

   <variablelist>
      <varlistentry>
	<term>t</term>
	<listitem>
	  <para>
	    Enable a breakpoint on a function.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>f</term>
	<listitem>
	  <para>
	    Disable an existing breakpoint without deleting it.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>d</term>
	<listitem>
	  <para>
	    Delete a breakpoint by name.
	  </para>
	</listitem>
      </varlistentry>
   </variablelist>


   <para>
     Watch points are debugger commands that drop you into the
     debugger console when the specified variable's value is either
     read, or changed.
   </para>

   <variablelist>
     <varlistentry>
       <term>name r</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is read.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>name w</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is
	   written to.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>name b</term>
       <listitem>
	 <para>
	   Set a watch point that triggers when the variable is read
	   or written to.
	 </para>
       </listitem>
     </varlistentry>
     
     <varlistentry>
       <term>d</term>
       <listitem>
	 <para>
	   Delete a watchpoint by name.
	 </para>
       </listitem>
     </varlistentry>
   </variablelist>
    
   <para>
     Break points are debugger commands that drop you into the
     debugger console when the specified function is about to be
     executed by the Flash VM.
   </para>

   <variablelist>
      <varlistentry>
	<term>set var [name] [value]</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>set stack [index] [value]</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>set reg [index] [value]</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>set global [index] [value]</term>
	<listitem>
	  <para>
	  </para>
	</listitem>
      </varlistentry>
   </variablelist>

</sect2>
  
