2008-03-22  Rob Savoye  <rob@ripple.welcomehome.org>

	* configure.ac: Change --enable-statistics to --with-statistics
	with settings for queues, buffers, and memory allocation as
	separate values for more fined grained control. Currently these
	are only used by Cygnal.

2008-03-22  Dossy Shiobara <dossy@panoptic.com>

	* libbase/tu_file.cpp (1.25): gettext 0.17 redefines printf in
	  libintl.h, which confuses cpp 3.x and causes a build failure
	  looking for tu_file::__printf__.

2008-03-21  Rob Savoye  <rob@ripple.welcomehome.org>

	* gui/kde.cpp: The names have changed in the enum, prefix GNASH_
	to MOD_SHIFT, etc...

2008-03-21 Russ Nelson <nelson@crynwr.com>

	* packaging/snapshot.am: dist-hook not needed anymore.

2008-03-22 Markus Gothe <nietzsche@lysator.liu.se>

	* libbase/sharedlib.cpp: Got rid off a couples of compiler warnings.
	Compare getenv with NULL not 0!.

2008-03-21  Dossy Shiobara <dossy@panoptic.com>

	* libbase/sharedlib.h (1.9): Tweak things so that libltdl works
	  correctly on Win32.

	* utilities/processor.cpp (1.92): Win32 lacks a usleep(), so we
	  fake it with Sleep().

	* server/asobj/SharedObject.cpp (1.37): mkdir() on Win32 only takes
	  one arg, apparently.

	* libmedia/ffmpeg/: ffmpegNetStreamUtil.h (1.3),
	  sound_handler_sdl.h (1.4): SDL_audio.h appears to need iconv.h on
	  Win32.

	* libmedia/AudioDecoderNellymoser.cpp (1.12): Win32 doesn't have
	  random() and srandom() but does have rand() and srand().

	* libbase/: rc.h (1.49), shm.cpp (1.7): Win32 lacks sys/shm.h, so
	  define key_t on Win32 as boost::uint32_t.

	* libbase/network.cpp (1.39): Win32 doesn't have the sa_family_t
	  type, nor the UNIX_PATH_MAX defined, or the sockaddr_un struct.

	* macros/pango.m4 (1.30): Use pangox on X11, pangowin32 on Win32.

	* gui/: gtk_glue_agg.cpp (1.34), gtk_glue_agg.h (1.17): Fix build
	  for when ENABLE_MIT_SHM is false, such as on Win32.

	* gui/: gtk_cairo_create.h (1.2), gtk_glue.h (1.15),
	  gtk_glue_cairo.h (1.16), gtk_glue_gtkglext.h (1.13), gtksup.h
	  (1.68): gdk/gdkx.h is for X11.  Win32 only has gdk/gdk.h.

	* gui/fltk.cpp (1.18), gui/gtk.cpp (1.159), gui/gui.cpp (1.143),
	  server/gnash.h (1.119): Fix some macro redefinition issues when
	  compiling with GCC 3.x, which does not have strongly typed enums.

	* server/vm/Makefile.am (1.20): If building with ffmpeg, we need
	  FFMPEG_CFLAGS.

2008-03-21  Rob Savoye  <rob@ripple.welcomehome.org>

	* configure.ac: Add conditional for win32 builds.

2008-03-21 Sandro Santilli <strk@keybit.net>

	* server/array.cpp, testsuite/server/AsValueTest.cpp:
	  Revert Markus patch (error: 'finite' is not a member of 'std').

2008-03-21 Markus Gothe <nietzsche@lysator.liu.se>

	* configure.ac: added tags for HP-UX and IRIX.
	* macros/opengl.m4: Fixed OGL-linking on OS X Leopard.
	* server/array.cpp: Fix compilation of isfinite.
	* testsuite/server/AsValueTest.cpp: Fix compilation of isfinite.

2008-03-20  Rob Savoye  <rob@ripple.welcomehome.org>

	* libbase/network.cpp: Return a 0 if the socket is never available
	for writing.

2008-03-20 Sandro Santilli <strk@keybit.net>

	* server/parser/sprite_definition.cpp (read):
	  If DefineSprite contains less SHOWFRAME then advertised
	  in header, still pretend all of the advertised frames
	  were loaded. This should be safe, and makes FlowPlayer
	  progress further (it exports an asset that advertise
	  1 frame and contains NO showframe tag).

2008-03-20 Sandro Santilli <strk@keybit.net>

	* server/character.{cpp,h}: add a virtual getMovieInfo.
	* server/movie_root.{cpp,h}: delegate character info gathering
	  to the characters themselves. 

2008-03-19  Rob Savoye  <rob@ripple.welcomehome.org>

	* libbase/network.cpp: Close the listener file descriptor too before
	restarting a connection.

2008-03-19 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (restart): only stop streaming
	  sound associated with the sprite, not *all* sounds !

2008-03-19 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loaders.cpp: log malformed swf if SOUNDSTREAMBLOCK
	  is found w/out preceeding SOUNDSTREAMHEAD.
	* testsuite/misc-ming.all/: Makefile.am,
	  streamingSoundTest1-Runner.cpp, streamingSoundTest1.c:
	  Stub test for streaming sound. Doesn't work yet, producing
	  a malformed SWF which inspired the tag_loaders.cpp change.

2008-03-19 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.{cpp,h}: always stop any streaming
	  sound when the sprite is stopped or unloaded.
	* server/parser/sound_definition.cpp, server/vm/ASHandlers.cpp:
	  update calls to cleaned up streaming sound interface of
	  sprite_instance.

2008-03-19 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/swfdec/swfdec_gnash_tester: use more complicated 
	  sed matching to handle newlines in trace output (one, anyway).
	* utilities/gprocessor: put all debugging output in log_debug
	  calls (or it gets caught in the sed rules).
	* testsuite/swfdec/PASSING: eight passing tests with newlines.

2008-03-19  Rob Savoye  <rob@ripple.welcomehome.org>

	* configure.ac: Add --enable-statistics, to turn on performance
	statistics gathering.

	* libbase/network.cpp: Actually use the timeout parameter to set
	the timeout. Turn off overly verbose debugging.

2008-03-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as: test addProperty(<valid_index>) 
	  against arrays. One more reason to use at least Property rather then
	  simple as_values.

2008-03-19 Sandro Santilli <strk@keybit.net>

	* server/as_object.{cpp,h}: enumerateNonProperProperty made protected,
	  add a virtual hasOwnProperty, made delProperty virtual.
	* server/array.{cpp,h}: implement hasOwnProperty and delProperty.
	* server/asobj/Object.cpp: use as_object::hasOwnProperty to implement
	  Object.hasOwnProperty().
	* testsuite/actionscript.all/array.as: more successes.

2008-03-19 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gnash.cpp: minor changes to 'usage' display.
	* cygnal/cygnal.cpp: remove unnecessary call to RcFile::loadfiles()
	  (this is called on construction); use Arg_parser to add long
	  options. Make output of usage consistent with gnash, update
	  copyright date; use cout for output, split into smaller
	  units for translation. Set locale for LC_ALL to avoid mangling
	  non-ASCII characters in some log messages.

2008-03-18 Sandro Santilli <strk@keybit.net>

	* server/array.{cpp,h}: use boost's mapped_vector for a sparse
	  array implementation. Saves space at some cpu cycles till all
	  gaps are filled (which happens by most modifiers, as an expected
	  behaviour :/).
	* testsuite/actionscript.all/array.as: successes in gaps filling.

2008-03-19 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as:
	  test splice() and members access on a sparse array.

2008-03-19 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gnash.cpp: remove duplicated --verbose in usage, add --version.
	* po/gnash.pot: updated after changes to gnash.cpp (shorter phrases
	  should also make translating less annoying).
	* po/de.po: fix messages broken by changes to gnash.cpp.

2008-03-18 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as:
	  test reverse(), join() and concat() on a sparse array.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Global.as: add more parseInt tests showing
	  some errors with hexadecimal parsing.
	* server/asobj/Global.cpp: rewrite parseInt to deal with most of the
	  main cases correctly.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/swfdec/swfdec_gnash_tester: don't use fromdos. It's
	  not always available and seems to be unnecessary.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/as_value.cpp: revert most of to_int() changes until
	  it's tested on i586.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/as_value.cpp: (to_int() again): work with unsigned values
	  until the return. Will hopefully fix for 32-bit platforms.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/as_value.cpp: last commit of this file was wrong.

2008-03-18  Rob Savoye  <rob@ripple.welcomehome.org>

	* libbase/lirc.{h,cpp}: Use byte_t instead of uint8_t.

	* libbase/network.{h,cpp}: Define NETBUFSIZE here instead of in
	cygnal/buffer. Define "byte_t" typedef for raw data, change all
	methods to use byte_t.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/array.cpp: tests for non-integer and
	  extreme integer indices.

2008-03-18 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/as_value.cpp: minor changes to to_int. It's a bit
	  complicated but seems to replicate how the pp converts to integers.
	  Don't need to use fmod().
	* server/vm/ASHandlers.cpp: use to_int() for ActionInt(). This fixes
	  handling of all negative non-integer numbers.
	* testsuite/actionscript.all/Global.as: add regression tests for
	  int().
	* server/asobj/string.cpp: minor cleanups; use safer string.at().
	* testsuite/swfdec/PASSING: tointeger passes after the changes above.

2008-03-18 Sandro Santilli <strk@keybit.net>

	* server/array.{cpp,h}: add concept of 'holes' in arrays, don't
	  enumerate holes.
	* testsuite/actionscript.all/array.as: update expected results.
	* server/character.cpp (width_getset, height_getset): don't abort
	  if the character being worked on has collapsed dimensions.

2008-03-18 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as: test sorting an array with
	  holes.

2008-03-17  Dossy Shiobara <dossy@panoptic.com>

	* plugin/: Makefile.am (1.71), mozilla-sdk/Makefile.am (1.18): Add
	  mozilla-sdk/include/prcpucfg-glibc.h and
	  mozilla-sdk/include/prcpucfg-win32.h to noinst_HEADERS to make
	  distcheck pass again.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/array.as: more tests for deletion
	  of array members.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* server/array.cpp (index_requested): don't turn a negative number
	  >= -1 to a valid index !!
	* testsuite/actionscript.all/array.as: add test for negative indexed
	  members.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gtk.cpp, gui/gnash.cpp: make clear that media handler
	  version information is static.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gtk.cpp: add media handler version information.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* server/as_environment.{cpp,h}: dump_stack: add additional
	  optional argument to limit number of stack items printed.
	* server/vm/ASHandlers.cpp (ActionSetRegister): use int rather
	  then uint8_t for sake of logging...
	* server/vm/ActionExec.cpp: limit stack dump to 32 items.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* server/movie_root.cpp (fire_mouse_event): catch ActionLimit
	  exceptions.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* doc/C/refmanual/logging.xml: update logging docs.

2008-03-17  Dossy Shiobara <dossy@panoptic.com>

	* plugin/mozilla-sdk/np_entry.cpp (1.11): Conditionally support
	  older NPAPI versions by using a more fine-grained approach to
	  copying the NPNetscapeFuncs structure.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/vm/ASHandlers.cpp: don't try to access an element of an
	  empty string; use string.at(), which would throw an exception if
	  we try to do so.
	* doc/C/usermanual/usage.xml: add new long options, correct some
	  descriptions.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/asobj/string.cpp: fix fromCharCode for SWF6+, sort
	  of fix it for SWF5. This would get more passes in the swfdec
	  testsuite if swfdec_gnash_tester could catch newlines in
	  trace output.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: fixed bug in testcase
	  making the business more complex then it was.

2008-03-17 Sandro Santilli <strk@keybit.net>

	* libbase/log.{cpp,h}: decouple LogFile and RcInitFile.
	  Add a LogFile::setLogFilename to specify a custom name
	  for the log file.
	* gui/Player.cpp: set LogFile filename as specified in the
	  rc file.
	* utilities/processor.cpp: set LogFile filename as specified
	  in the rc file.

2008-03-17 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/asobj/string.cpp: String.substr(): an undefined second
	  argument is the same as having only one argument.
	* server/vm/ASHandlers.cpp: action substring: make variable names
	  consistent with mbsubstring; use C++ string methods and handle
	  utf-8 properly for different versions.
	* testsuite/actionscript.all/String.as: update / add tests for
	  substring and String.substr (now passing).

2008-03-16 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/Player.{h,cpp}: handle an empty url, fix misc-ming.all failures.
	  Take std::string& instead of const char* - there seems to be no case
	  in which distinguishing between NULL and empty is useful.
	* testsuite/actionscript.all/String.as: add test comparing substring
	  and String.substr, showing that both are broken.

2008-03-15  Dossy Shiobara <dossy@panoptic.com>

	* plugin/win32/: plugin.cpp (1.15), plugin.h (1.11): Track whether
	  the module was properly initialized (i.e., NS_PluginInitialize()
	  was called) as it seems at least Firefox 2.0.0.12 on WinXP will
	  continue to load and run npgnash.dll even if it hasn't been.

	  Eliminated the (unnecessary?) getPluginDescription().  Matter of
	  fact, NS_PluginGetValue() isn't used on XP_WIN builds at all.

	  Reflect change in function name from
	  gnash::register_fscommand_callback to
	  gnash::registerFSCommandCallback.

2008-03-15  Dossy Shiobara <dossy@panoptic.com>

	* plugin/mozilla-sdk/np_entry.cpp (1.10): On Firefox
	  2.0.0.12/WinXP, aNPNFuncs->size is 172 while
	  sizeof(NPNetscapeFuncs) is 184.  However, npgnash.dll continues
	  to work fine even though NPNFuncs isn't populated (!), and as a
	  matter of fact, Firefox seems to ignore the
	  NPERR_INVALID_FUNCTABLE_ERROR return from NP_Initialize and
	  continues to load and execute npgnash.dll, anyway.  Therefore, we
	  should continue and execute NS_PluginInitialize anyway, too.

	  c.f. https://savannah.gnu.org/bugs/?20835

2008-03-15  Dossy Shiobara <dossy@panoptic.com>

	* plugin/mozilla-sdk/include/: prcpucfg-glibc.h (1.1),
	  prcpucfg-win32.h (1.1), prcpucfg.h (1.13): NSPR's prcpucfg.h is
	  platform-specific.  Added Win32 version to CVS as
	  prcpucfg-win32.h, renamed old prcpucfg.h to prcpucfg-glibc.h, and
	  replaced prcpucfg.h with a stub that tries to include the correct
	  one.

2008-03-15  Dossy Shiobara <dossy@panoptic.com>

	* plugin/mozilla-sdk/include/: npapi.h (1.9), npupp.h (1.8): Update
	  NPAPI from 0.14 to 0.19, using header files from
	  mozilla/modules/plugin/base/public: npapi.h (3.48), npupp.h
	  (3.26).

2008-03-15 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gnash.cpp: mend url. Fixes bug #22609.

2008-03-15 Sandro Santilli <strk@keybit.net>

	* server/swf_function.cpp: don't put 'this' into a register if
	  the SUPPRESS_THIS flag is on.
	* testsuite/swfdec/PASSING: definefunction2-this.swf

2008-03-15 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (CommonGetUrl): cast uint8_t to int when
	  printing, fixing a failure in misc-mtasc testsuite (output log
	  considered binary).

2008-03-15 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionMbSubString): fix the opcode, and
	  avoid out-of-range accesses. Fixes panda.swf (bug #22437)
	* testsuite/actionscript.all/String.as: add tests for mbsubstring.
	  Gnash used to fail a lot there.

2008-03-15 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: finally some more failing 
	  tests (equivalent to swfdec's super-missing-{7,8}.swf)

2008-03-15 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gnash.cpp: change / add some long options and update help output.
	  Add --fullscreen to allow starting in fullscreen mode.
	* gui/Player.{h,cpp}: implement starting in fullscreen mode.

2008-03-15 Sandro Santilli <strk@keybit.net>

	* gui/gnash.cpp: fix build with GNASH_FPS_DEBUGGING defined.
	* testsuite/actionscript.all/Inheritance.as: test double gap in
	  inheritance chain.

2008-03-15 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* libbase/arg_parser.{cpp,h}: add slightly modified version of
	  Antonio Diaz Diaz's C++ Arg_parser class.
	* libbase/Makefile: build arg_parser.
	* gui/gnash.cpp: use Arg_parser to add long options. Make --help
	  more concise (we have a manual), abolish printf where it's not
	  useful for translation (which is almost everywhere). 

2008-03-15 Sandro Santilli <strk@keybit.net>

	* server/debugger.cpp: fix compilation.
	* server/vm/ASHadlers.cpp (ActionCallMethod): for SWF7+ compute
	  super from the actual object containing the called function
	  (also when finding out from super).
	* testsuite/actionscript.all/Inheritance.as: successes.

2008-03-15 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Inheritance.as: more tests for 
	  gaps in inheritance chain (SWF7+ fails in gnash).
	* server/stream.cpp: use the float conversion function found
	  in action_buffer, hopefully working fine on big endian hosts
	  (to be tested).

2008-03-14  Rob Savoye  <rob@ripple.welcomehome.org>

	* doc/C/Makefile.am: Install the preformatted info pages too.

	* macros/kde.m4: Set plugin paths here instead of configure.ac.
	* configure.ac: Move Kparts config code to kde.m4. Default to
	$HOME/.kde instead of system wide, fixing all installation
	permissions problems.

2008-03-14 Sandro Santilli <strk@keybit.net>

	* server/as_environment.cpp: when dumping local registers and
	  variables only show the ones in current (top) call frame, not
	  all of them.
	* server/stream.{cpp,h}: substitute the ambiguos read_float
	  with read_short_float and read_long_float.
	* server/parser/filter_factory.cpp: use read_long_float for
	  bitmap filter parsing (fixes a parse error in sevenload.de
	  player.swf); more verbose parsing.

2008-03-14 Sandro Santilli <strk@keybit.net>

	* server/swf/PlaceObject2Tag.cpp: log more about PlaceObject3
	* server/fill_style.cpp: use an int for the temporary num_gradients.
	* server/textformat.cpp: warn once about unimplemented TextFormat.
	* server/asobj/LoadVars.cpp: don't trace onData and onLoad methods
	  enter.
	* server/asobj/MovieClipLoader.cpp: don't trace MovieClip destruction.

2008-03-14 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (sprite_startDrag): handle
	  NaN args (we should probably use ints for dragging in
	  general). Fixes bug #22592.

2008-03-14 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/fill_style.cpp: cast uint8_t to int before logging.

2008-03-14 Sandro Santilli <strk@keybit.net>

	* server/video_stream_instance.h: implement pointInShape (for the
	  sake of removing the error log in default implementation, but
	  it does the same thing as the former).

2008-03-14 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* libbase/tree.hh: update to version 2.51
	* server/movie_root.cpp: tinker with the tree a bit more.

2008-03-14 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/movie_root.{h,cpp}: add getMovieInfo() to fill the info tree
	  with data. Added more data about movie stage and from public methods
	  of gnash::character. This class will eventually get its own tree
	  filler method.
	* gui/gui.cpp: delegate some tree filling to movie_root.

2008-03-14 Sandro Santilli <strk@keybit.net>

	* server/font.cpp (read_font_info): initialize the device font
	  provider if a name was read. Fixes bug #22367.
	* testsuite/swfdec/REALTIME: run netstream-status.swf in realtime.
	* server/movie_root.cpp (cleanDisplayList): make sure NO unloaded
	  characters are in the live instances container after a call to
	  this method.
	* testsuite/actionscript.all/Inheritance.as: test gaps in the
	  inheritance chain. Gnash fails for SWF>6.

2008-03-13 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/render_handler_cairo.cpp: Partially implement invalidated
	bounds, improving performance by approximately 10%.

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Microphone.as: more comprehensive tests
	  for the Microphone class.

2008-03-13  Dossy Shiobara <dossy@panoptic.com>

	* plugin/win32/: plugin.cpp (1.14), plugin.h (1.10): Use the
	  Windows GDI DIB buffer directly with AGG, eliminating an
	  unnecessary buffer and memcpy.  Correctly prevent multiple
	  streams from launching a player thread.  Implement mouse movement
	  and clicking support.

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Stage.as: More tests for Stage.align.
	  It's obvious what it does now.
	* server/asobj/Stage.{h,cpp}: make Stage.align methods work properly.
	  It's still not really implemented. More swfdec passes.
	* testsuite/swfdec/PASSING: passing tests.

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Stage.as: Stage methods were
	  available in SWF5, but weren't native.
	* server/asobj/Stage.cpp: init Stage methods for SWF5, but
	  don't register them as Native (one more swfdec testsuite pass).

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gui.cpp: Reorganize movie properties, add a few more.

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Stage.as: some passing tests.

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Stage.as: tests with different cases,
	  whitespace and extra characters.
	* server/asobj/Stage.{h,cpp}: add _displayState member, implement
	  displayState getter-setter. Make checks case-insensitive, but
	  not yet tolerant of whitespace or extra characters.
	* gui/Player.cpp: listen for displayState. 

2008-03-13 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/MovieTester.{h,cpp}: add support for resizing.
	* gui/gui.cpp: minor cleanup.
	* server/asobj/Stage.cpp: minor cleanups.
	* testsuite/actionscript.all/Stage.as: tests for Stage.displayState.

2008-03-13 Sandro Santilli <strk@keybit.net>

	* server/as_object.cpp: implement get_text_value for as_super.
	* testsuite/swfdec/PASSING: object-valueof-{6,7,8} succeed.

2008-03-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/render_handler_cairo.cpp: Store some ints as ints.
	* gui/gtk_glue_cairo.{cpp,h}: Make the GTK window single-buffered,
	because we provide our own double-buffering mechanism. configure():
	Try to create a buffer that's similar to the GDK buffer. This
	significantly improves performance. render(): Implement invalidated
	bounds.

2008-03-12 Bastiaan Jacques <bastiaan@bjacques.org>

	* backend/render_handler_ogl.cpp: Compliation fix.

2008-03-12 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: super-reference-{7,8} succeed.
	* testsuite/actionscript.all/Inheritance.as: last failing test pass
	  (we need a lot more now !!)
	* server/as_object.h: make findProperty public.
	* server/vm/ASHandlers.cpp (ActionCallMethod): use findProperty
	  to find the actual object containing the named method to call,
	  and compute super from that IFF swf > 7.

2008-03-12 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: super-reference-6.swf succeeds.
	* server/as_function.cpp (function_call): set super.
	* testsuite/actionscript.all/Stage.as: successes..

2008-03-12 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/edit_text_character.cpp: don't use == when comparing
	  floats.
	* server/asobj/Stage.cpp: return actual stage size when scaleMode
	  is noScale. This allows the stage resize listeners to work
	  out what to do (which is the point of noScale).
	* server/movie_root.cpp: minor cast cleanup.

2008-03-12 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/asobj/Stage.cpp: don't call align 'width'; implement
	  getting and setting Stage.align, though it won't do anything.

2008-03-12 Sandro Santilli <strk@keybit.net>

	* backend/render_handler_agg.cpp,
	  libmedia/ffmpeg/VideoDecoderFfmpeg.{h,cpp}
	  boost::foreach.hpp is not available as of boost-1.33.1.

2008-03-12 Sandro Santilli <strk@keybit.net>

	* server/PropertyList.{cpp,h} (setValue): allow passing flags to use
	  when creating new properties.
	* server/as_object.cpp: avoid the double scan when initializing
	  members. Have super register a proper __proto__ member.

2008-03-12 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all: tests for Stage properties and 
	  Stage.align values.

2008-03-12 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/Makefile.am: don't add LDFLAGS (AGG_LIBS)
	  to GNASH_LIBS, don't list GNASH_LIBS as dependency of test
	  runners (should be imported by libgnashtestsuite.la).

2008-03-12 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* po/de.po: Updated translation by Alwin Meschede.
	* po/sv.po, cs.po, es.po, fi.po, fr.po, it.po: updated po files.

2008-03-12  Dossy Shiobara <dossy@panoptic.com>

	* plugin/win32/: plugin.cpp (1.13), plugin.h (1.9): Overhaul of
	  Win32 npgnash.dll, implementing in-process Gnash in a player
	  thread, using AGG renderer and SDL/ffmpeg for sound.

	* plugin/win32/npgnash.rc (1.4): Cleaned up resource file and
	  modified it to masquerade as "Shockwave Flash" so JavaScript
	  checks on Win32 will detect Gnash as a Flash player.

	* plugin/win32/npgnash.def (1.1): Explicitly export
	  NP_GetEntryPoints, NP_Initialize and NP_Shutdown symbols in
	  npgnash.dll.

	* plugin/win32/: npgnash.c (1.1), npgnash.cpp (1.9): Renamed from
	  .cpp to .c to avoid having to wrap the whole file in an extern
	  "C".

	* plugin/win32/npgnash_resource.h (1.2): No longer needed.

2008-03-11 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: If --enable-visibility is specified, and no GCC bug
	was detected, compile with -fvisibility=hidden.
	* server/shape.{cpp, h}: Since SWF provides shape edges as integers,
	there's no need to store them as floats. Some renderers can improve
	performance here, especially when used on certain embedded platforms.
	To this end, path and edge are now templated classes Path<> and
	Edge<>, and the precision (int or float) can be specified with the
	template argument.
	* backend/render_handler_agg.cpp: The AGG renderer relies on
	floating pointprecision in paths (after matrix conversion), so make
	sure that precision is preserved.
	* libgeometry/{Point2d.h, Range2d.h}: Allow easy conversion from float
	to int templates.
	* server/matrix.{cpp, h}: Allow transformations to take place on any
	kind of Point2d and Range2d.
	* server/types.h: Multiplication by 20 does not require a floating
	point annotation.
	* server/parser/BitmapMovieDefinition.cpp: Specify the "new subshape"
	argument to Path's constructor.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/*.as: re-add rcsids.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Date.as: fix test count.

2008-03-11 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gtk.cpp, gui/Player.cpp: minor code cleanups.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* server/vm/ASHandlers.cpp (ActionCallFunction): only
	  maintain the 'this' pointer if in a function context.
	* testsuite/actionscript.all/Inheritance.as: one xfail
	  less.

2008-03-11 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/Player.cpp: add stubs for all fscommand methods, implement
	  showmenu.
	* gui/gui.{h,cpp}: add showMenu().
	* gui/gtk{.cpp,sup.h}: implement showMenu for gtk (mainly for 
	  fscommand "showmenu").

2008-03-11 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Object.as: check that toLocaleString
	  calls toString. Add some tests for when toLocaleString is implemented
	  at all.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/: Date.as, Object.as:
	  Use hasOwnProperty for new 'toLocaleString' availability
	  testing.

2008-03-11 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Date.as: tests for toLocaleString.
	* testsuite/actionscript.all/Object.as: tests for toLocaleString.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* backend/Makefile.am: distribute ogl backend header.
	* ChangeLog, ChangeLog-0.8.2, Makefile.am: split ChangeLog.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/registerClassTest.c: more tests
	  for __constructor__ and constructor of instances with
	  registered class.

2008-03-11 Sandro Santilli <strk@keybit.net>

	* server/sprite_instance.cpp (constructAsInstance): compute
	  a 'super' reference.
	* testsuite/misc-ming.all/registerClassTest.c: test super in
	  registered-class constructor.
	* server/as_object.cpp: mark reachable resources from 'super'
	  (may live longer then a function call, if that's the user
	  intention).
	* testsuite/actionscript.all/MovieClip.as: check 'constructor'
	  and '__constructor__' members of builtin class instances.

2008-03-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/StringPredicates.h: Make case insensitive compare work with
	old boost, take two.

2008-03-10 Sandro Santilli <strk@keybit.net>

	* server/vm/fn_call.h: add a 'super' member in the function call.
	* server/vm/action.{cpp,h}: allow passing a 'super' object to
	  call_method.
	* server/as_object.{cpp,h}: implement get_constructor,
	  reimplement get_super, add isSuper virtual function,
	  provide a special 'as_super' class.
	* server/as_function.cpp (constructInstance): provide proper 'super'
	  reference.
	* server/as_value.cpp (typeOf): advertise the super object as an
	  'object'
	* server/swf_function.cpp: use fn_call::super as the super reference.
	* server/vm/ASHandlers.cpp (ActionCallFunction, ActionCallMethod):
	  properly setup a 'super' in function calls.
	* testsuite/actionscript.all/Inheritance.as: new successes.
	* testsuite/misc-mtasc.all/Makefile.am: super_test1.swf succeeds.
	* testsuite/swfdec/PASSING: 8 super-related tests succeed.

2008-03-10 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* doc/C/usermanual/gnashrc.xml: add information about ignoreFSCommands
	  directive.
	* doc/C/refmanual/internals.xml: correct typo.
	* gui/gui{h.cpp}: allow exiting after a set number of advances.
	* gui/Player.{h.cpp}: same. Fscommand is case insensitive.
	* gui/gnash.cpp: add switch (-m) for setting max advances. This
	  will probably be changed soon to a long option. Drop unused
	  switches and code.

2008-03-10 Sandro Santilli <strk@keybit.net>

	* testsuite/generic-testrunner.sh: sleep less.
	* testsuite/misc-ming.all/Makefile.am: re-enabled
	  instanceNameTestRunner, erroneously dropped by
	  in revision 1.184 (when adding BOOST_CFLAGS).

2008-03-10 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* utilities/processor.cpp: make fscommand test case insensitive.

2008-03-10 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: don't rely on
	  playing slow..
	* testsuite/misc-mtasc.all/Dejagnu.as: quit when done.

2008-03-10 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gtk.cpp: change cursor only over the drawing area.
	  Prevents the mouse staying invisible over menus. Drop
	  a line I accidentally added some time ago.

2008-03-10 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/gnash.h: third time lucky: interfaceEventCallback
	  returns a std::string to allow a range of responses.
	* gui/Player.{h,cpp}: adapt interfaceEventCallback method
	  to return std::string. Clean up names of private member
	  variables.
	* gui/gui.{h,cpp}: add flag for whether mouse pointer
	  is shown or hidden.
	* gui/gtk{sup.h,.cpp}: implement mouse hide/show for GTK.
	* doc/C/refmanual/internals.xml: update some docs.

2008-03-10 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/gnash.h: make interfaceEventCallback return bool to
	  allow response from the gui. Rename register_fscommand_callback
	  to registerFSCommandCallback and make it take const std::string&
	  arguments.
	* server/as_object.{h,cpp}: remove callback from as_object and
	* server/movie_root.{h,cpp}: put it in movie_root for use with
	  other events (e.g. ActionLimits hit).
	* server/asobj/Mouse.cpp: update callback to movie_root.
	* server/vm/ActionExec.cpp: update registerFSCommandCallback.
	* gui/Player.{h,cpp}: adapt interfaceEventCallback methods,
	  implement some fscommands (quit, fullscreen).
	* gui/gui.{h,cpp}: add isPlugin() method for deciding whether to
	  handle fscommands.
	* libbase/rc.{cpp,h}: add ignoreFSCommands directive to allow, well,
	  ignoring fscommands. Set to true by default.
	* utilities/processor.cpp: update registerFSCommandCallback.

2008-03-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/StringPredicates.h: Use std::lexicographical_compare instead
	of boost::ilexicographical_compare, because the latter is not
	available in boost 1.33.

2008-03-09 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/gnash.h: add "interfaceEventCallback" callback for passing
	  AS events to the gui.
	* server/as_object.{cpp,h}: make callback a static method of as_object
	  class, as that's where it's used.
	* gui/Player.{h,cpp}: register Player as a listener for interface event
	  callbacks and pass on to gui.
	* gui/gui.{cpp,h}: make Mouse.hide and Mouse.show unimplemented in the
	  gui, not in mouse_as_object.
	* server/asobj/Mouse.cpp: send mouse events using callback.

2008-03-07 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/StringPredicates.h: Use boost string algorithms instead of
	the current home-grown ones.
	* server/vm/ASHandlers.cpp: getTime() returns int, so there's no point
	in rounding it to the nearest integer.

2008-03-07 Russ Nelson <nelson@crynwr.com>

	* Fix typos and unwieldy grammar in doc/C/*.xml and doc/C/userman/*.xml
	* Remove Klash, renaming to kde-gnash and kparts as needed.

2008-03-07 Sandro Santilli <strk@keybit.net>

	* server/swf_function.cpp: arguments.callee is not enumerable
	  by default.
	* testsuite/actionscript.all/Function.as: test for default
	  enumerable properties of 'arguments' succeeds.

2008-03-07 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/Function.as: expect a failure on
	  composition of the 'arguments' object. Was already broken,
	  used to succeed due to another bug (availability of a 'size'
	  property, which wasn't supposed to be there..).

2008-03-07 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/asobj/string.cpp: a negative number passed as second
	  argument to lastIndexOf always returns -1. More swfdec
	  testsuite passes.
	* testsuite/swfdec/PASSING: update passing tests.

2008-03-07 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-mtasc.all/function_test.as: add a couple
	  more tests.

2008-03-07  Rob Savoye  <rob@ripple.welcomehome.org>

	* testsuite/libbase/memtest.cpp: Add tests for time stamps.
	* libbase/gmemory.h: Add nano resolutions timestamps.
	* libbase/memory.cpp: Add timestamps so we can test performance
	too.

2008-03-07 Sandro Santilli <strk@keybit.net>

	* server/as_value.cpp (to_debug_string): add class name
	  for functions too.

2008-03-07 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/asobj/string.cpp: substring end pos is also set to
	  0 if it's a negative number and, where relevant, swapped with
	  start pos. More swfdec testsuite passes.
	
2008-03-07 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* gui/gui.{h,cpp}: make data tree-shaped instead of flat.
	* gui/gtk.cpp: update properties dialogue to use tree view.

2008-03-06  Rob Savoye  <rob@ripple.welcomehome.org>

	* testsuite/libbase/memtest.cpp: Figures, malloc() on Ubuntu and
	Fedora differs in what it allocates. Ubuntu seems to like 16
	bytes pages,. Fedoras gives us what we ask for, and aligns the
	memory later. Both behaviours are correct.

	* libbase/gmemory.h: Renamed from memory.h to avoid name
	collisions. 
	* libbase/memory.h: Renamed to gmemory.h to avoid name
	collisions. 

2008-03-06  Rob Savoye  <rob@ute.welcomehome.org>

	* configure.ac: Add a test for mallinfo();
	* testsuite/libbase/memtest.cpp: New test case for the Memory
	debugger for use by maintainers.
	* testsuite/libbase/Makefile.am: Add new memory testv case.
	* libbase/memory.{h,cpp}: New Memory class for analysing memory
	allocation to find leaks and bloat.
	* libbase/makefile.am: Add memory.*.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/array.cpp: there's no such thing as an Array.size member, and
	  use a native getter/setter for 'length'.
	* testsuite/actionscript.all/array.as: test that Array instances
	  don't have any 'size' member.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/as_value.{cpp,h}: cleanup: remove the unused drop_refs
	  and destructor (both doing nothing).

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/swfdec/PASSING: add passing Chr tests.
	* testsuite/actionscript.all:String.as: passing tests.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/movie_root.cpp (markReachableResources): character mouse and
	  key listeners also don't need to be scanned again as all left would
	  be on stage.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/fill_style.cpp: cast log arg to int, or boost::format will
	  interpret as a character (string).
	* server/movie_root.cpp (markReachableResources): don't mark live
	  chars as reachable, as they should be marked by their parent
	  already (was a TODO item).

2008-03-06 Sandro Santilli <strk@keybit.net>

	* libbase/GC.{cpp,h}: ok not calling size() twice, but
	  don't properly update the last managed resources count..

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/vm/ASHandlers.cpp: implement MbOrd for SWF6+ and utf-8,
	  clean up the other chr and ord functions a bit.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* libbase/GC.cpp: minor thing, don't call std::list::size() twice each
	  frame iteration, as it's O(n) for GNU stdc++ lib...

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/button_character_instance.cpp, server/sprite_instance.cpp,
	  server/video_stream_instance.cpp, server/asobj/NetConnection.cpp,
	  server/asobj/NetStream.cpp, server/asobj/Sound.cpp,
	  server/asobj/Stage.cpp, server/asobj/string.cpp,
	  server/asobj/xmlnode.cpp:
	  Further reduce builtin_function for native getter/setters.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/: Property.{cpp,h}, PropertyList.{cpp,h},
	  as_object.{cpp,h}:
	  Add support for native getter-setters.
	* server/sprite_instance.cpp: use native getter-setters
	  for sprite properties.
	* server/vm/Machine.cpp: don't assume a getter setter is
	  always implemented using an as_function.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* server/asobj/Global.cpp: cast istringstream to bool as a way
	  to detect errors, tellg() == -1 was ambiguos.
	* testsuite/actionscript.all/String.as: fix expected results
	  (could not handle to find a working comparison for multibyte
	  chars in swf5).

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/String.as: add tests for mbchr (should
	  be correct) and mbord(not yet confirmed).

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Global.as: correct test count.
	* server/asobj/Global.cpp: forget lexical_cast, use stringstream
	  instead. That both fixes the locale problem and doesn't mess up
	  parsing of non-numeric characters.

2008-03-06 Sandro Santilli <strk@keybit.net>

	* testsuite/actionscript.all/MovieClip.as: add test for override
	  of native properties (or getter/setters).

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* testsuite/actionscript.all/Global.as: add some checks that would
	  have caught a mistake in parseFloat.

2008-03-06 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* server/vm/ASHandlers.cpp: fix mbchr to return a UTF-8 string;
	  make sure both mbchr and chr handle characters only up to
	  65535. Fixes behaviour for SWF6, 7, and 8.
	* configure.ac: update version (flash compatibility) to 9,0,999 so
	  that javascript flash detectors don't reject gnash (not helpful for
	  implementing SWF9).
	* server/asobj/Global.cpp: use boost_lexical cast in parseFloat;
	  sscanf looks only for the decimal separator of the locale,
	  which since a localization change is now always the local
	  locale; actionscript uses the 'C' locale.

2008-03-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* libamf/{amf.h, element.h, lcshm.h, sol.h},
	libbase/{GC.h, WallClockTimer.h, libbase/shm.h, string_table.h}
	libmedia/gst/{VideoDecoderGst.h, GstUtil.h}, 
	server/{PropertyList.h, SystemClock.h, as_environment.h,
	as_function.h, character.h, shape.h, timers.h}: Add DSOEXPORT
	where a symbol is used outside of the DSO where it's implemented.
	Allows compilation with -fvisibility=hidden.
	* libbase/utility.{cpp h}, libmedia/{AudioDecoder.h,
	AudioDecoderSimple.cpp, Makefile.am}: Move convert_raw_data to
	libmedia.

2008-03-04 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* libbase/log.cpp: remove silly assertion.
	* testsuite/libamf.all/test_object.cpp: use std::string hexify.

2008-03-04 Sandro Santilli <strk@keybit.net>

	* testsuite/swfdec/PASSING: added tests that only failed due to 
	  traces being truncated.
	* cygnal/crc.cpp: update to build after changes in RcInitFile
	  interface.

2008-03-04 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* libbase/log.{h,cpp}: add templates to convert from vsnprintf format
	  logging calls to boost::format. These are generated with 
	  boost.preprocessor macros. The templates 'redirect' log_* calls
	  to logProcess_* functions. These can also be used directly.
	  Switching between the two is possible by changing the #define
	  USE_BOOST_FORMAT in log.h. It is enabled by default. Make static
	  members private, as they aren't needed elsewhere. Make hexify()
	  return a std::string and look much less scary.
	* libamf/element.cpp, libamf/sol.cpp: use std::string hexify.
	* server/parser/action_buffer.cpp: use std::string hexify.
	* server/vm/ASHandlers.cpp: use C++ standard header <locale>
	* utilities/dumpshm.cpp: use <locale>, change hexify.
	* utilities/processor.cpp: use <locale>.

2008-03-04 Sandro Santilli <strk@keybit.net>

	* libbase/GC.{cpp,h}: add a countCollectables() method for stats.
	* gui/gui.cpp: print collectables count in the movie properties
	  menu.

2008-03-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/array.h server/dlist.cpp server/URLAccessManager.cpp: More
	proper namespacing. Fixes build with GCC 4.3.

2008-03-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* server/asobj/xmlnode.cpp: Add a direct include and proper
	namespacing for GCC 4.3.

2008-03-04 Benjamin Wolsey <benjamin_pelican@yahoo.co.uk>

	* libbase/rc.{h,cpp}: const correct; clean up parsing, avoiding
	  an extra iteration at the expense of constructing
	  a stringstream; add warning on unrecognized commands; general
	  cleanup of other functions; drop ':' separator for lists, which
	  has been deprecated for a while. Document functions.

2008-03-04 Bastiaan Jacques <bastiaan@bjacques.org>

	* all over the place: Remove $Id tags, because it has not been shown
	that they serve a real purpose; however, they do cause problems.

