2007-06-14 Zou Lunkai <zoulunkai@gmail.com>

	* server/parser/morph2_character_def.h: implement a get_bound() for
	  morphs, should fix an old displaying problem of morphs.
	  
2007-06-14 Hubert Figuiere <hfiguiere@novell.com>

	* Makefile.am, configure.ac: look for freetype2, not freetype
	  (for pkg-config to be effective). Rename _CFLAGS and _LIBS
	  to be FREETYPE2, not FREETYPE
	* server/Makefile.am, server/parser/Makefile.am: 
	  Use FREETYPE2_{CFLAGS,LIBS}
	* server/FreetypeGlyphsProvider.cpp: use an FT_CONST macro
	  to switch between constness of Outline walker func between
	  freetype 2.1 (wants non-const) and 2.2 (wants const).

2007-06-14 Zou Lunkai <zoulunkai@gmail.com>

	* server/character.h, 
	  server/dlist.h,
	  server/dlist.cpp, 
	  server/sprite_instance.h,
	  server/sprite_instance.cpp,
	  server/parser/morph2_character_def.cpp,
	  server/swf/PlaceObject2Tag.h,
	  server/swf/PlaceObject2Tag.cpp,
	  server/vm/action.cpp,
	  testsuite/server/DisplayListTest.cpp,
	  change type of "ratio" from float to integer, don't re-interpret the definition.
	  
2007-06-13 Petr Pisar <petr.pisar@atlas.cz>

	* gui/gtk.cpp: internationalize menus. (patch #6006).

2007-06-13 Andrew Guertin <bugzilla@dolphinling.net>

	* configure.ac: removes the duplicate "Checking" and adds the missing
	  newline while checking for archiver type.
	* macros/agg.m4: print the missing "checking for AGG headers" line.
	  (patch #5933)

2007-06-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextTest.c: put reduced margins
	  back, to verify no word wrap works.
	* server/edit_text_character.cpp (format_text): implement no word wra
	* server/FreetypeGlyphsProvider.{cpp,h}: document coordinate space of
	  getGlyph output values and implement proper scaling between freetype
	  glyph EM units and our 1024 EM square.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/: font.{cpp,h}, Makefile.am, FreetypeRasterizer.{cpp,h},
	  FreetypeGlyphsProvider.{cpp,h}: renamed file and class since
	  we won't serve rendered glyphs anymore. Rendered glyphs can
	  always be obtained by rendering the shape_character_def,
	  the code should be buried somewhere in fontlib.cpp.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/font.cpp (add_os_font): use the advance value
	  computed by getGlyph, not getRenderedGlyph (the latter
	  is bogus).

2007-06-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/loop_test8.c: xchec -> check.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/font.{cpp,h}: always maintain m_advance_table of the 
	  same size of the other two glyph info containers (should really
	  make a structure keeping all of them..). Fixes an testInvariant
	  failure with the device font selector (see DeviceFonts page
	  on wiki).

2007-06-13 Sandro Santilli <strk@keybit.net>

	* configure.ac: look for libfontconfig
	* Makefile.am: print fontconfig info on 'dumpconfig'
	* server/FreetypeRasterizer.{cpp,h}: implement font name
	  to filename matching using fontconfig, when available;
	  updated copyright info (enough hacking on it now..)
	* server/Makefile.am: add FONTCONFIG cflags and libs.
	* testsuite/misc-ming.all/DefineEditTextTest.c: add another
	  text field using 'times' font.

2007-06-13 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/Makefile.am:
	  fix a typo(thank strk).
	  
2007-06-13 Sandro Santilli <strk@keybit.net>

	* configure.ac: newlines are tokens with bourne shell !

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.cpp: fix build w/out libfreetype.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/DefineEditTextTest.c:
	  Apply transformation to text characters.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* gui/gtk.cpp, server/FreetypeRasterizer.cpp,
	  server/fontlib.cpp, server/movie_root.cpp,
	  server/text.cpp: Reduced verbosity.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.{cpp,h}: Implement shape_character_def
	  output using DynamicShape; changed getGlyph method to also take
	  an 'advance' output parameter (toward deprecation of bitmap output).
	* server/font.cpp (add_os_glyph): update call to ::getGlyph.

2007-06-13 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.{cpp,h}: added interface
	  to fetch vectorial glyph (just a stub).
	* server/font.cpp (add_os_glyph): fetch both rasterized
	  and vectorial glyphs, survive to texture glyphs with a null
	  bound (space is one such glyph).
	* server/fontlib.cpp (draw_glyph): skip rendering of textured
	  glyphs with null bounds.
	* server/text.cpp (display_glyph_records): enable debugging by
	  default.

2007-06-12 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.cpp (getRenderedGlyph): don't assume
	  "suspeded_image" is not-null after creation of the bitmap_info_alpha
	  instance (those bitmap interfaces needs a big cleanup really...).
	* testsuite/misc-ming.all/DefineEditTextTest.c:
	  Test both embedded and device fonts.

2007-06-12 Sandro Santilli <strk@keybit.net>

	* configure.ac: Look for libfreetype using GNASH_PKG_FIND
	* server/FreetypeRasterizer.{cpp,h}: use HAVE_FREETYPE_H,
	  use intrusive_ptr for bitmap_info, not auto_ptr; add missing
	  includes, make it actually buildable.
	* server/Makefile.am: Build FreetypeRasterizer
	* server/parser/Makefile.am: add FREETYPE_CFLAGS
	* server/edit_text_character.cpp (format_text): stop relying
	  on font::get_glyph_count, as for device fonts count of glyph
	  is not known in advance (grows as needed).
	* server/font.{cpp,h}: Add private methods for initialization
	  and use of a freetype rasterizer; get_glyph_index() will now
	  try to create a missing glyph.
	* server/parser/bitmap_character_def.h: add forward declaration
	  for image::rgb

2007-06-12 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/loop_test8.c:
	  correctly set ratio, forgot in last commit.
	  
2007-06-12 Zou Lunkai <zoulunkai@gmail.com>

	* testsuite/misc-ming.all/loop_test8.c, Makefile.am:
	  new testcase for timeline control, focus on ratio.
	  
2007-06-11 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.{cpp,h}: 
	  Add missing stub for font filename finder method.

2007-06-11 Zou Lunkai <zoulunkai@gmail.com>

	* gui/sdl_agg_glue.cpp: initialize member variables at construction, 
	  fix an abortion when loading nonexistent swf files.
	
2007-06-10 Bastiaan Jacques <bastiaan@bjacques.org>

	* gui/kde{sup.h, .cpp}: Comment out debugging statements. Make
	setTimeout work. Quit KdeGui gracefully rather than calling
	exit(0). Avoid conversion compiler warnings. Switch class
	pointers to auto_ptr. Small code cleanups.
	* gui/kde_glue_agg{.cpp, .h}: Contain the rendering buffer in
	a scoped_array.

2007-06-10 Sandro Santilli <strk@keybit.net>

	* gui/Makefile.am: klash.moc is a source file for the kde
	  gui.

2007-06-09 Bastiaan Jacques <bastiaan@bjacques.org>

	* configure.ac: Allow the KDE GUI to be compiled against AGG.
	* gui/Makefile.am: Compile KDE/AGG files when requested.
	* gui/kde.cpp: Make the KDE GUI compatible with AGG by moving
	OpenGL-specific code into its respective glue. Also fix mouse
	movement in combination with scaling.
	* gui/kde_glue.h: Add stubs for AGG compatibility.
	* gui/kde_glue_opengl.cpp: run makeCurrent in the glue.
	* gui/kdesup.h: Allow the AGG glue to be used.
	* gui/kde_glue_agg{.cpp, .h}: Initial implementation of AGG
	glue for QT/KDE.

2007-06-09 Sandro Santilli <strk@keybit.net>

	* libbase/embedVideoDecoderFfmpeg.cpp (decodeFrame): do not
	  access a null decodedFrame (tgc: please check).

2007-06-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/embedVideoDecoderFfmpeg.{cpp,h}: Store decodedFrame
	  in an auto_ptr to avoid possible leaks.

2007-06-08 Sandro Santilli <strk@keybit.net>

	* server/FreetypeRasterizer.{cpp,h}: Ported truetype
	  rasterizer from gameswf, cleaned up and documented
	  (as far as understood).

2007-06-08 Sandro Santilli <strk@keybit.net>

	* libbase/embedVideoDecoderGst.{cpp,h}: Store decodedFrame
	  in an auto_ptr to avoid leaks. Fix the case in which
	  there's NO decoded frame (ie: no gst-ffmpeg installed)
	  previously segfaulting by simply running
	  Video-EmbedSquareTestRunner.

2007-06-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* server/asobj/NetStreamFfmpeg.cpp: Don't leave the decoding
	  loop/thread until the queues are empty, or the media left
	  in the queues wont get played.
	* server/movie_root.cpp: Include action.h, not Action.h.
	* libbase/embedVideoDecoderFfmpeg.cpp: Changed the image copying,
	  and check if the decoded videoframe is bigger than expected.


2007-06-08 Zou Lunkai <zoulunkai@gmail.com>

	* server/as_object.{h,cpp}: add a virtual on_event() for event handler. 
	* movie_root.{h,cpp}: add a new KeyListener class.
	* server/asobj/Key.{h ,cpp}, sprite_instance.cpp, edit_text_character.cpp,
	  button_character_instance.cpp: adopt new KeyListener interface.
	* server/character.h: change getUserDefinedEventHandler() from private to public.
	  all in all, merged two listener lists into one.
	  
2007-06-08 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler_sdl.cpp: Fixed an assertion fault
	  when non-mp3 audio was looping.

2007-06-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/embedVideoDecoderFfmpeg.cpp: Free the av_frame after use.
	* server/swf/tag_loaders.cpp: Adjust size of audio after decoding.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* macros/ffmpeg.m4: check for libgsm and add to FFMPEG_LIBS if
	  available.
	* testsuite/anaylse-results.sh: don't forget to initialize
	  total_untested.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* doc/C/Makefile.am: distribute all XML files.
	* macros/docbook.m4: advertise --enable-docbook, not
	  --disable-docbook since it's disabled by default.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* configure.ac: disable klash if QT lib aren't found.
	* gui/Makefile.am: add kde_glue.h  in KDE_SRCS (hopefully this adds
	  to distribution).

2007-06-07 Sandro Santilli <strk@keybit.net>

	* configure.ac: hint user about using AGG if framebuffer gui is
	  requested.
	* server/Makefile.am, utilities/Makefile.am:
	  Moved the libgnashbackend dependency out of libgnashserver
	  and into the utilities/ dir. This is to avoid a circular
	  dependency I erroneously introduced with my last 
	  commit aimed at fixing bug #20110. This should be a better
	  fix.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.{cpp,h}: add a canTestVideo() method.
	* testsuite/misc-ming.all/NetStream-SquareTestRunner.cpp: don't
	  wait for Play.Stop event to be sent if video can't be tested
	  (ie: not supported by mad).

2007-06-07 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/installation/building.xml: mention that
	  GNOME help is a possible documentation make target.  Completed
	  instructions for building documentation; added instructions for 
	  testing from old manual.
	* doc/C/usermanual/installation/feature_configuration.xml: The
	  default renderer isn't AGG. FLTK works. Spelling fixes.
	  Comment out TODO/FIXME sections, so that they are not visible 
	  to users, but can still be searched.
	* doc/C/usermanual/installation.xml: Changed the title of this
	  section.
	* doc/C/usermanual/installation/install.xml: Added information on
	   where Gnash installs.
	* doc/C/usermanual/installation/custompath_configuration.xml,
	   doc/C/usermanual/usage.xml: Comment out TODO/FIXME sections, 
	  so that they are not visible to users, but can still be searched.
	* doc/C/usermanual/installation/testing_dependencies.xml,
	   doc/C/usermanual/installation/documentation_dependencies.xml,
	   doc/C/usermanual/installation/code_dependencies.xml: Resolved
	   TODO items in the dependency tables (package names).
	* doc/C/usermanual/bugreport.xml: Described how to make a bug
	  report.
	* doc/C/usermanual/glossary.xml: Created the glossary.
	* doc/C/sources.xml: Removed file; the replacement is
	   doc/C/usermanual/installation/sources.xml.
	* doc/C/gnashrc.xml: Removed file; it has been moved to
	  doc/C/usermanual/usage/gnashrc.xml.
	* doc/C/gnash.xml: Replace the old usermanual + developer
	  information with the new usermanual.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* server/Makefile.am: add libgnashbackend to libserver LDADD.
	  Fixes bug #20110.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.cpp (checkPixel): print an UNTESTED
	  message if no renderers were initialized. This gives you
	  a feel about how many tests are we failign to run when building
	  with a renderer that doesn't provide testing facilities.
	* testsuite/anaylse-results.sh: print untested in report.
	* testsuite/MovieTester.h: add a canTestRendering() method.
	* testsuite/misc-ming.all/Video-EmbedSquareTestRunner.cpp: 
	  Don't run the pixel checking part if MovieTester can't test
	  rendering. Raise an UNTESTED label instead, so it's reported.

2007-06-07 Sandro Santilli <strk@keybit.net>

	* libgeometry/snappingrange.h: initialize all members in the
	  templated copy ctor.

2007-06-07 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* backend/sound_handler.cpp: Fixed a warning.
	* backend/sound_handler_gst.cpp: Small cleanup.
	* libbase/embedVideoDecoder{Ffmpeg, Gst}.cpp: Made more robust, can
	  now handle if render image format is NONE. Should fix bug #20111.

2007-06-07 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/edit_text_character.cpp: better version of previous patch;
	  gets rid of WIDTH_FUDGE too 	

2007-06-07 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* server/edit_text_character.cpp: shift text by 2 pixels, 
	  fixes bug #17954

2007-06-07 Zou Lunkai <zoulunkai@gmail.com>

	* server/sprite_instance.cpp: improved call_frame_actions(), 
	  avoid using possibly invalidated interators.
	
2007-06-06 Sandro Santilli <strk@keybit.net>

	* server/swf/tag_loader.cpp (fixme_loader): warn only once for each
	  unimplemented tag found in SWF streams during a run.

2007-06-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: add checks for known scale 	
	  and preset scale to 1:1 so that "make check" succeeds again

2007-06-06 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* libbase/embedVideoDecoder.h: Added docs and made decodeFrame 
	  return a auto_ptr.
	* libbase/embedVideoDecoderFfmpeg.{cpp,h}: Made decodeFrame 
	  return a auto_ptr.
	* libbase/embedVideoDecoderGst.{cpp,h}: Made decodeFrame 
	  return a auto_ptr, and fixed a deadlock.
	* server/video_stream_instance.cpp: embedVideoDecoder::decodeFrame 
	  now returns a auto_ptr, adjust to that.

2007-06-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: dynamic cast check 	

2007-06-06 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/eventSoundTest1-Runner.cpp: don't test sound
	  if sound is not supported.

2007-06-06 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: apply stage scaling to matrix,
	  don't multiply each coordinate (should improve rendering performance) 	

2007-06-06 Sandro Santilli <strk@keybit.net>

	* testsuite/MovieTester.{cpp,h}: Don't abort if sound support wasn't
	  compiled in. Add a canTestSound() method to query that capability.

2007-06-06 Sandro Santilli <strk@keybit.net>

	* configure.ac: If no --enable-media was specified, use the first
	  detected one in this order: ffmpeg/gst/mad. This is to allow
	  ./configure with no args to be more failsafe (useful on 'make
	  distcheck'). If you guys like this patch I'd backport to 0.8 branch.

2007-06-06 Sandro Santilli <strk@keybit.net>

	* testsuite/samples/Makefile.am: distribute subshapes.swf, as we're
	  now using it for testing purposes.
	* testsuite/misc-ming.all/Makefile.am: VideoEmbed-SquareTest.swf
	  depends on testsuite/media/square.flv ! Fixes bug #20090.
	* testsuite/misc-ming.all/NetStream-SquareTest.c: Fixed test for
	  bytesTotal since the .flv was actually updated... Fixes bug #20096.
	* configure.ac: don't set CXXFLAGS as a side-effect of the SIZET_FMT
	  tests if not already set by user.
	* Makefile.am: Add print of CXXFLAGS at 'make dumpconfig' time.

2007-06-05 Tomas Groth Christensen <tomasgroth@yahoo.dk>

	* testsuite/media/square.flv: Changed the movements in the movie to
	  be more fluent so that testing is easier.
	* testsuite/misc-ming.all/Video-EmbedSquareTestRunner.cpp: Check if
	  the video really does play.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* configure.ac: support --without-extensions.
	* testsuite/samples/: Makefile.am, subshapes-TestRunner.cpp:
	  Test runner for subshapes.swf (see bug #20084).
	* testsuite/MovieTester.cpp (addTestingRenderer): register the first
	  and only tested renderer immediately, to be more tolerant about
	  limitations in the core lib preveing hot-swap of renderers.

2007-06-05 Ann Barcomb <kudra@domaintje.com>

	* doc/C/usermanual/usage/gnashrc.xml: Copy Sandro's commit
	  1.3435 of doc/C/gnashrc.xml to the new gnashrc.xml
	* many files: Changed my email address

2007-06-05 Udo Giacomozzi <udo.gnu@nova-sys.net>

	* backend/render_handler_agg.cpp: correct matrix transformation
	  for rotated video; switch to /cloning/ image accessor to
	  make edges smooth for rotated video	
	
2007-06-05 Zou Lunkai <zoulunkai@gmail.com>

	* server/as_object.h: change operator "==" to "=", should fix a typo.
	  
2007-06-04 Sandro Santilli <strk@keybit.net>

	* README: some opcode and classes are actually implemented now.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* server/video_stream_instance.{cpp,h}: register Video AS class
	  interface and provide class initialization.
	* server/asobj/: Global.cpp, Makefile.am, Video.{cpp,h}: Drop Video file, video
	  class is now implemented in video_stream_instance.cpp
	* testsuite/misc-ming.all/NetStream-SquareTest.c: don't expect
	  failures due to video stream character NOT being a real Video
	  object.

2007-06-04 Sandro Santilli <strk@keybit.net>

	* testsuite/misc-ming.all/NetStream-SquareTest.c: set SWF rate back to
	  an high value to allow for testing pixel color and also testing with
	  eyes what's hard to test when nothing is shown due to Gnash not
	  supporting sub-SWF rate videos; Scale video by 120% and rotate 45
	  degrees clockwise to verify video transform
	  bugs (not automated yet); documented expected behaviour; add 
	  tests for matrix transforming properties.
